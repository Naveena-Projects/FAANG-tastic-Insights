# FAANG-tastic-Insights
## Predict Stock Prices with Regression and MLflow

## Problem Statement
- Imagine you are a data scientist working at a leading fintech company. Your goal is to develop an intelligent and user-friendly Streamlit web application that predicts the closing price of FAANG stocks based on user inputs. The tool should empower financial analysts and retail investors by simplifying complex data-driven decisions, providing them with accurate regression-based predictions of stock prices.

## Data Set Explanation
A comprehensive list of the columns in your dataset, along with descriptions for each:
-	Company	: The name of the company (e.g., Apple, Facebook).
-	Ticker		: The stock ticker symbol for the company (e.g., AAPL for Apple, META for Facebook).
-	Date		: The trading date for the stock data.
-	Open		: The opening price of the stock for the trading day.
-	High		: The highest price of the stock during the trading day.
-	Low		: The lowest price of the stock during the trading day.
-	Close		: The closing price of the stock for the trading day.
-	Adj Close	: The adjusted closing price, which accounts for dividends and stock splits.
-	Volume	: The number of shares traded during the day.
-	Market Cap	: The total market value of a company's outstanding shares.
-	PE Ratio	: Price-to-earnings ratio; a measure of a company's current share price relative to its per-share earnings.
-	Beta		: A measure of a stock's volatility in relation to the market.
-	EPS		: The portion of a company's profit allocated to each outstanding share of common stock.
-	Forward PE	: The price-to-earnings ratio using forecasted earnings.
-	Revenue	: Total revenue reported by the company.
- Gross Profit	: The profit a company makes after deducting the costs associated with making and selling its products.
-	Operating Income	: The profit realized from a business's normal operations, excluding any income derived from non-operational activities.
-	Net Income	: The total profit of a company after all expenses, taxes, and costs have been deducted from total revenue.
-	Debt to Equity	: A financial ratio indicating the relative proportion of shareholders' equity and debt used to finance a company's assets.
-	Return on Equity (ROE): A measure of financial performance calculated by dividing net income by shareholders' equity.
-	Current Ratio	: A liquidity ratio that measures a company's ability to pay short-term obligations or those due within one year.
-	Dividends Paid	: The total dividend payments made by the company.
-	Dividend Yield	: A financial ratio that shows how much a company pays out in dividends each year relative to its stock price.
-	Quarterly Revenue Growth	: The year-over-year percentage growth in revenue for the most recent quarter compared to the same quarter last year.
-	Analyst Recommendation	: Analysts' consensus rating for the stock (e.g., buy, sell, hold).
- Target Price		: The forecasted price for the stock as estimated by analysts.
-	Free Cash Flow	: The cash generated by the company after accounting for capital expenditures.
-	Operating Margin	: A measure of how much profit a company makes on a dollar of sales after paying for variable costs.
-	Profit Margin		: The percentage of revenue that has turned into profit.
-	Cash Ratio	: A liquidity ratio that measures the amount of cash available to cover current liabilities.
-	Quick Ratio	: A measure of a company's ability to meet its short-term obligations with its most liquid assets.
-	Price to Book Ratio	: A financial measure used to compare a company's market value to its book value.
-	Enterprise Value	: A measure of a company's total value, often used as a more comprehensive alternative to market capitalization.
-	Total Debt	: The total amount of debt the company owes.
-	Total Assets	: The total assets owned by the company.
-	Total Equity	: The total equity held by shareholders.
-	Beta (5Y)	: A measure of a stock's volatility in relation to the market over the past five years.
-	Annual Dividend Rate		: The total dividends paid annually divided by the number of shares outstanding.
-	Trailing Twelve Months (TTM) Revenue	: Revenue reported for the last 12 months.
- Trailing Twelve Months (TTM) EBITDA	: Earnings before interest, taxes, depreciation, and amortization for the last 12 months.
-	Trailing Twelve Months (TTM) Earnings	: Net income for the last 12 months.


## Objectives
- Develop and train different regression models and Compare them in MLflow to register the best model
- Create an interactive Streamlit application for users to predict their stock prices

## Data cleaning and manipulation
- To ensure data quality and consistency, the following preprocessing steps were performed:
- Dropped 9 columns that were entirely empty and held no analytical value.
- Removed 5 additional columns that lacked data specifically for one or two companies like Netflix and Amazon, hence were not deemed critical for the analysis 
- Total number of columns reduced from 41 to 27.
- Standardized the 'Date' column to ensure a uniform datetime format across the dataset.
- Handled outliers in key numerical features such as price and volume by clipping extreme values using IQR method, minimizing their impact on model training.

## EDA
### 1. Basic analysis
- Columns related to company capital and revenue ratios contain static numerical values specific to each company, making them effectively categorical. Encoding them as categorical features becomes redundant since the company names already capture this information.
- Additionally, due to the large variance in these static numerical values, leaving them unencoded could negatively impact model training and prediction.
- Therefore, columns with extremely high or low static values were dropped.

### 2. Close price trend over the years
<img width="1194" height="453" alt="image" src="https://github.com/user-attachments/assets/be8e79e8-dad4-459f-a9c2-6e94bff0cb01" />

-  The line plot visualizes the closing stock prices of Apple, Facebook, Google, Amazon, and Netflix from 2006 to 2024. 
- While all companies show steady growth, Netflix and Facebook exhibit significant price surges post-2015, indicating strong market performance. 
- Temporary drops around 2020 may reflect COVID-19’s market impact, followed by recovery and continued growth. 

### 3. Yearly average of close prices of different companies
<img width="1356" height="555" alt="image" src="https://github.com/user-attachments/assets/a206889c-940c-48cd-93b5-245d4a43fa6b" />

- The plot shows a steady rise in average close prices for all five companies over the years, with noticeable growth post-2015.
- Netflix and Facebook experienced the sharpest rises particularly after 2017 and 2022.
- Google, Apple and Amazon followed a more stable and consistent upward trend, reflecting sustained performance.

### 4. Volume of stocks traded over the years 
<img width="1234" height="418" alt="image" src="https://github.com/user-attachments/assets/19e2f2ab-c4ab-4e24-bb08-f0becf3c4d73" />

- Apple consistently had the highest trading volume until around 2010, after which it experienced a steady decline.
- Google and Amazon followed a similar trend, with high trading volumes in the early years that gradually decreased over time.
- Facebook and Netflix maintained comparatively lower trading volumes, yet their stock prices remained relatively high.
- Overall, the trading volume across all companies shows a declining trend, possibly indicating a reduction in speculative trading activity.

### 5. Scatter plot of volume of stocks and corresponding close prices
<img width="1241" height="435" alt="image" src="https://github.com/user-attachments/assets/3040df52-242d-4a63-a0dd-544519a9d2db" />

-  There is a clear pattern where higher trading volumes are associated with lower closing prices.
- A dense cluster of points appears near the left side of the plot (lower volumes) with a wide range of closing prices.
- This suggests that most of the time, trading volume is low and closing prices can vary significantly.
- As volume increases, the range of closing prices narrows and concentrates at the lower end of the price spectrum.
- This could imply that high trading volumes often coincide with lower stock prices — possibly during times of high selling pressure or market downturns.

## Encoding 
To prepare the dataset for model training, the following encoding steps were applied:
- The Date column was decomposed into three separate numerical features: Year, Month, and Day, to better capture temporal patterns.
- The Analyst Recommendation column contained only 'Yes' values and was therefore encoded as 1.
- One-hot encoding was applied to the categorical column Company to convert them into a format suitable for machine learning algorithms.
- Ticker column is very similar to the company name hence dropped and date column is also dropped from the data 

## Feature selection
### Correlation Matrix
<img width="1383" height="661" alt="image" src="https://github.com/user-attachments/assets/4612e0cf-8c97-44fb-9069-1783e3d07b08" />

-  Close price is highly correlated with Open, High, Low, and Adj Close, while EPS and Target Price show moderate positive correlation.
- Volume, Market Cap, and cash flow metrics have weak to moderate negative correlation, and financial ratios offer limited predictive value.
- Price and volume appear to be key predictors, as other financial metrics (like revenue and ratios) are mostly static—possibly averaged—making them less useful for modeling and prone to distortion if encoded or left unprocessed.
- Columns with extreme data ranges (e.g., values above 1e5 or below 0) are dropped to avoid skewing the model.
- Selected features include date, price-related columns, volume, analyst recommendations, and moderately varying financial metrics like EPS, PE Ratio, and Current Ratio.


## Model development in ML Flow
<img width="1385" height="700" alt="image" src="https://github.com/user-attachments/assets/cb240bc7-87ca-494e-878a-8acdce8154a4" />

-  Preprocessed and scaled the dataset to ensure consistent and reliable input for model training.
- Trained multiple regression models with various algorithms and hyperparameters, including Decision Tree, Random Forest, Gradient Boosting Regressor, Support Vector Regressor, and XGBoost.
- Stored model performance metrics (RMSE, MAE, R²) in a structured DataFrame (results_df) for comparison.
- Logged experiments in MLflow under “Prediction of Stock Prices,” capturing model parameters, metrics, and artifacts.
- Compared model runs via the MLflow UI to identify the best-performing model based on evaluation metrics.
- Registered the top model (XGBoost) in the MLflow Model Registry for versioning and future deployment.


## Streamlit application:
<img width="1560" height="810" alt="image" src="https://github.com/user-attachments/assets/14bad736-efce-4c29-8c9e-66610ce5b65e" />

- Developed a user-friendly, interactive webpage using Streamlit that enables users to predict stock prices based on their input.
- Users can select a company using radio buttons and choose a date from a calendar, with options available for over a year.
- Adjust sliders to set the stock's opening, low, and high prices, as well as trading volume.
- Choose values for PE Ratio, EPS, Forward PE, Current Ratio, Target Price, and Quick Ratio from the respective dropdown menus.
- Select the analyst recommendation (e.g., Buy or Sell) based on user preference.
- Click the Predict Stock button to generate and view the predicted stock price.


## Summary
- Performed data cleaning, preprocessing, and exploratory analysis to prepare the dataset.
- Encoded categorical features and selected relevant columns for training multiple regression models.
- Logged all model runs and metrics in an MLflow experiment to compare performance and register the best model.
- Saved the processed data for reuse and developed a Streamlit web app to predict stock prices based on user inputs.
